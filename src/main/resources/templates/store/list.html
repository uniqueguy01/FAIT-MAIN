<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<th:block th:replace="~{/fragment/head.html :: header}"></th:block>
<script type="text/javascript"
	src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=sd5ebt0f3n&submodules=geocoder"></script>
<style>
body {
	background-color: #fff;
	font-family: 'Noto Sans KR', sans-serif;
	padding-top: 80px;
	color: #333;
}

.store-banner {
	position: relative;
	margin-bottom: 0;
}

.store-banner img {
	width: 100%;
	height: 300px;
	object-fit: cover;
}

.store-info {
	position: absolute;
	bottom: 20px;
	left: 40px;
	background: rgba(0, 0, 0, 0.6);
	color: white;
	padding: 20px 30px;
	border-radius: 12px;
}

.store-info h2 {
	font-size: 2rem;
	margin: 0;
	font-weight: bold;
}

.store-tabs {
	display: flex;
	justify-content: center;
	background-color: #fafafa;
	border-bottom: 1px solid #ccc;
}

.tab {
	padding: 18px 30px;
	cursor: pointer;
	text-decoration: none;
	color: #333;
	font-weight: 500;
	border-bottom: 3px solid transparent;
}

.tab.active {
	border-bottom: 3px solid #000;
	font-weight: 700;
}

.tab-content {
	display: none;
	padding: 40px 80px;
}

.tab-content.active {
	display: block;
}

.product-container {
	display: flex;
	flex-wrap: wrap;
	gap: 24px;
}

.product-card {
	width: 200px;
	border: 1px solid #ddd;
	border-radius: 10px;
	overflow: hidden;
	background-color: #fff;
	transition: transform 0.2s ease-in-out;
}

.product-card:hover {
	transform: translateY(-5px);
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.product-card img {
	width: 100%;
	height: 200px;
	object-fit: cover;
}

.product-card p {
	margin: 8px 0;
	text-align: center;
	font-size: 0.95rem;
	font-weight: 500;
}

.map-notice-wrapper {
	display: flex;
	gap: 40px;
	margin-top: 40px;
	align-items: flex-start;
	border-top: 1px solid #333;
	padding-top: 30px;
	margin-top: 60px;
}

#map {
	flex: 4;
	height: 500px;
	border: 1px solid #ccc;
	border-radius: 8px;
}

.notice-area {
	flex: 1;
}

.notice-area textarea {
	width: 100%;
	padding: 10px;
	font-size: 1rem;
	border: 1px solid #ccc;
	border-radius: 8px;
	resize: vertical;
}

.notice-area button {
	margin-top: 10px;
	padding: 10px 20px;
	background-color: #000;
	color: #fff;
	border: none;
	border-radius: 5px;
	cursor: pointer;
}

.maker-wrapper {
	margin-top: 60px;
}

.maker-wrapper h3 {
	margin-bottom: 20px;
	font-size: 1.5rem;
	font-weight: 600;
	padding-bottom: 10px;
	border-bottom: none;
}

.maker-section {
	display: flex;
	flex-direction: row;
	gap: 40px;
	flex-wrap: nowrap;
	justify-content: space-between;
	padding: 30px 0;
	border-top: 1px solid #333;
	margin-top: 20px;
}

.maker-section .maker {
	flex: 1;
	display: flex;
	align-items: flex-start;
	gap: 15px;
}

.maker-section img {
	width: 260px;
	height: 260px;
	object-fit: cover;
	border-radius: 8px;
}
</style>

</head>
<body>
	<div th:replace="/fragment/nav.html :: nav"></div>
	<main>
		<section class="store-banner">
			<th:block th:each="img : ${item.storeImg}">
				<th:block th:if="${img.type == 'banner'}">
					<img th:src="@{'/upload/' + ${img.uuid} + '_' + ${img.filename}}"
						alt="Store Banner" />
				</th:block>
			</th:block>
			<div class="store-info">
				<h2 th:text="${item.name}">가게 이름</h2>
			</div>
		</section>
		<div class="store-tabs">
			<a href="#" class="tab active" data-tab="design">Shoes Design</a> <a
				href="#" class="tab" data-tab="profile">Store Profile</a> <a
				href="#" class="tab" data-tab="event">Store Event</a>
		</div>
		<section id="design" class="tab-content active">
			
			<!-- 상품(신발) -->
			<h3>Signature Shoes</h3>
			<div class="product-container">
				<div class="product-card" th:each="shoe : ${list}">
					<a th:href="@{'/shoe/detail/' + ${shoe.id}}"> <img
						th:src="@{'/upload/' + ${shoe.shoeImg[0].uuid} + '_' + ${shoe.shoeImg[0].filename}}"
						alt="신발 이미지"
						th:if="${shoe.shoeImg != null and !shoe.shoeImg.isEmpty()}" />
					</a>
					<p th:text="${shoe.name}">신발 이름</p>
					<p th:text="'₩' + ${shoe.price}">가격</p>
				</div>
			</div>
			<th:block th:each="category : ${categories}">
				<h3 th:text="${category}">카테고리명</h3>
				<div class="product-container">
					<div class="product-card" th:each="shoe : ${list}"
						th:if="${shoe.category == category}">
						<a th:href="@{'/shoe/detail/' + ${shoe.id}}"> <img
							th:src="@{'/upload/' + ${shoe.shoeImg[0].uuid} + '_' + ${shoe.shoeImg[0].filename}}"
							th:if="${shoe.shoeImg != null and !shoe.shoeImg.isEmpty()}"
							alt="제품 이미지" />
						</a>
						<p th:text="${shoe.name}">신발 이름</p>
						<p th:text="'₩' + ${shoe.price}">가격</p>
					</div>
				</div>
			</th:block>
		</section>
		<section id="profile" class="tab-content">
			<h3>Shoe Maker</h3>
			<div class="maker-section">
				<div class="maker" th:each="maker : ${item.maker}">
					<img
						th:src="@{'/upload/' + ${maker.uuid} + '_' + ${maker.filename}}"
						alt="작가 이미지">
					<div>
						<p th:text="${maker.name}" style="margin: 0; font-weight: 600;"></p>
						<p th:text="${maker.info}" style="margin: 0;"></p>
					</div>
				</div>
			</div>

			<h3>Map</h3>

			<div class="map-notice-wrapper">
				<div id="map"></div>
				<div class="notice-area">
					<h3>공지사항</h3>
					<div th:if="${isOwner}">
						<form th:object="${item}" method="post"
							th:action="@{/store/notice/{id}(id=${item.id})}">
							<textarea th:field="*{notice}" rows="10"></textarea>
							<button type="submit">저장</button>
						</form>
					</div>
					<div th:unless="${isOwner != null and isOwner}"
						style="white-space: pre-wrap;">
						<p
							th:text="${item.notice != null and !item.notice.isEmpty() ? item.notice : '등록된 공지사항이 없습니다.'}"></p>
					</div>
				</div>
			</div>
		</section>
		<section id="event" class="tab-content"></section>
	</main>
	<script>
document.querySelectorAll(".tab").forEach(tab => {
	tab.addEventListener("click", e => {
		e.preventDefault();
		document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
		document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
		tab.classList.add("active");
		document.getElementById(tab.dataset.tab).classList.add("active");
	});
});
</script>
	<script th:inline="javascript">
window.addEventListener("DOMContentLoaded", function () {
	let roadAddress = /*[[${item.address}]]*/ '기본주소';
	const map = new naver.maps.Map('map', {
		center: new naver.maps.LatLng(37.5665, 126.9780),
		zoom: 16
	});
	naver.maps.Service.geocode({ query: roadAddress }, function (status, response) {
		if (status !== naver.maps.Service.Status.OK || response.v2.addresses.length === 0) {
			alert('지도를 표시할 수 없습니다.');
			return;
		}
		const result = response.v2.addresses[0];
		const coord = new naver.maps.LatLng(result.y, result.x);
		map.setCenter(coord);
		new naver.maps.Marker({ map: map, position: coord });
	});
});
</script>
</body>
</html>