<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<th:block th:replace="~{/fragment/head.html :: header}"></th:block>
<script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=sd5ebt0f3n&submodules=geocoder"></script>
<style>

	.store-banner {
	    position: relative;
	    margin-bottom: 20px;
	}
	
	.store-info {
	    position: absolute;
	    bottom: 20px;
	    left: 20px;
	    background: rgba(0, 0, 0, 0.5);
	    color: white;
	    padding: 15px;
	    border-radius: 8px;
	}
	
	.store-info h2 {
	    margin: 0 0 5px 0;
	}
	    
	body {
		font-family: 'Noto Sans KR', sans-serif;
		margin: 0;
		padding: 0;
	}
	
	.store-tabs {
		display: flex;
		justify-content: center;
		background-color: #f0f0f0;
		border-bottom: 1px solid #ddd;
	}
	
	.tab {
		padding: 15px 25px;
		cursor: pointer;
		text-decoration: none;
		color: #333;
		border-bottom: 3px solid transparent;
	}
	
	.tab.active {
		border-bottom: 3px solid #000;
		font-weight: bold;
	}
	
	.tab-content {
		display: none;
		padding: 30px;
	}
	
	.tab-content.active {
		display: block;
	}
	
	.product-card {
		display: inline-block;
		width: 180px;
		margin: 10px;
		text-align: center;
	}
	
	.product-card img {
		width: 100%;
		height: 180px;
		object-fit: cover;
	}
	
	.store-info {
		background-color: #f9f9f9;
		padding: 20px;
		margin-bottom: 20px;
	}
	
	.event-item {
		background-color: #fff8f0;
		border: 1px solid #f0d6b6;
		padding: 15px;
		margin-bottom: 15px;
	}
	
</style>

<!-- 탭 전환 -->
<script>
	window.addEventListener("DOMContentLoaded", () => {
	    const tabs = document.querySelectorAll(".tab");
	    const contents = document.querySelectorAll(".tab-content");
	
	    tabs.forEach(tab => {
	        tab.addEventListener("click", function (e) {
	            e.preventDefault();
	
	            // 모든 탭과 콘텐츠 비활성화
	            tabs.forEach(t => t.classList.remove("active"));
	            contents.forEach(c => c.classList.remove("active"));
	
	            // 클릭한 탭과 해당 콘텐츠 활성화
	            this.classList.add("active");
	            const id = this.dataset.tab;
	            document.getElementById(id).classList.add("active");
	        });
	    });
	});
</script>

<script th:inline="javascript">
window.addEventListener("DOMContentLoaded", function () {
    // 백엔드에서 전달된 주소
    let roadAddress = /*[[${item.address}]]*/ '기본주소';

    // 기본 지도 생성
    const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(37.5665, 126.9780), // 초기 좌표 (서울시청)
        zoom: 16
    });

    // 주소 → 좌표 변환
    naver.maps.Service.geocode({ query: roadAddress }, function (status, response) {
        if (status !== naver.maps.Service.Status.OK || response.v2.addresses.length === 0) {
            console.error('주소 변환 실패:', status, response);
            alert('지도를 표시할 수 없습니다. 주소를 확인해주세요.');
            return;
        }

        const result = response.v2.addresses[0];
        const coord = new naver.maps.LatLng(result.y, result.x);

        // 지도 중심 이동
        map.setCenter(coord);

        // 마커 생성
        new naver.maps.Marker({
            map: map,
            position: coord,
            title: roadAddress
        });
    });

    // 탭 전환 후 지도 resize 처리 (지도 짤림 방지)
    const profileTab = document.querySelector('[data-tab="profile"]');
    profileTab.addEventListener("click", function () {
        setTimeout(() => {
            naver.maps.Event.trigger(map, 'resize');
        }, 300);
    });
});
</script>

</head>
<body>
	<header>
		<a href="/">Fait Main</a>
	</header>

	<main>
		
		<!-- 가게 배너 이미지 -->
		<section class="store-banner">
		    <img th:if="${item.storeImg != null and !item.storeImg.isEmpty()}"
     			 th:src="@{'/upload/' + ${item.storeImg[0].uuid} + '_' + ${item.storeImg[0].file}}"
		         alt="Store Banner" style="width: 100%; max-height: 350px; object-fit: cover;" />
		    
		    <div class="store-info" style="padding: 20px;">
		        <h2 th:text="${item.name}">가게 이름</h2>
		    </div>
		</section>

		<!-- 탭 메뉴 -->
		<div class="store-tabs">
			<a href="#" class="tab active" data-tab="design">Shoes Design</a> <a
				href="#" class="tab" data-tab="profile">Store Profile</a> <a href="#"
				class="tab" data-tab="event">Store Event</a>
		</div>
	
		<!-- Shoes Design -->
		<section id="design" class="tab-content active">
			<h3>Signature Shoes</h3>
			<div class="product-card" th:each="shoe : ${list}">
			    <th:block th:if="${shoe.shoeImg != null and !shoe.shoeImg.isEmpty()}"
			              th:with="imgPath='/upload/' + ${shoe.shoeImg[0].uuid} + '_' + ${shoe.shoeImg[0].file}">
			        <img th:src="@{${imgPath}}" alt="신발 이미지"/>
			    </th:block>
			    <p th:text="${shoe.name}">신발 이름</p>
			    <p th:text="'₩' + ${shoe.price}">가격</p>
			</div>
	
			<h3>옥스포드</h3>
			<div th:each="shoe : ${list}">
			    <div class="product-card" th:if="${shoe.category == '옥스포드'}">
			        <img th:if="${shoe.shoeImg != null and !shoe.shoeImg.isEmpty()}"
			             th:src="@{'/upload/' + ${shoe.shoeImg[0].uuid} + '_' + ${shoe.shoeImg[0].file}}"
			             alt="제품 이미지"/>
			        <p th:text="${shoe.name}">신발 이름</p>
			        <p th:text="'₩' + ${shoe.price}">가격</p>
			    </div>
			</div>
		</section>
	
		<!-- Store Profile -->
		<section id="profile" class="tab-content">
			<div>
				<h3>ShoeMaker</h3>
				<div th:each="maker : ${item.maker}">
					<img th:src="@{'/upload/' + ${maker.uuid} + '_' + ${maker.file}}" alt="작가 이미지">
					<p th:text="${maker.name}">작가 이름</p>
					<p th:text="${maker.info}">작가 정보</p>
				</div>
				
				<h3>Map</h3>
				<!-- 네이버 지도 api -->
				<div id="map" style="width:100%;height:400px;"></div>
				
				
				<h3>Review</h3>
			</div>
		</section>
	
		<!-- Store Event -->
		<section id="event" class="tab-content">
			
		</section>
	</main>
</body>
</html>