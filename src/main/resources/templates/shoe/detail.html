<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Fait Main Detail</title>
<th:block th:replace="/fragment/head.html :: header"></th:block>

<style>
.dropdown-wrapper {
	position: relative;
	width: 250px;
	font-family: sans-serif;
}

.dropdown-label {
	background: #f8f8f8;
	padding: 10px;
	font-weight: bold;
	border: 1px solid #ccc;
	border-radius: 6px;
	cursor: pointer;
}

.dropdown-list {
	position: absolute;
	top: 100%;
	left: 0;
	right: 0;
	max-height: 200px;
	border: 1px solid #ccc;
	border-top: none;
	background: #fff;
	overflow-y: auto;
	display: none;
	z-index: 1000;
}

.dropdown-item {
	padding: 10px;
	border-bottom: 1px solid #eee;
	cursor: pointer;
}

.dropdown-item:hover {
	background: #f0f0f0;
}

.selected {
	color: #007bff;
}
</style>

<script>
    window.addEventListener("DOMContentLoaded", () => {
    	const dropdown = document.getElementById("dropdown");
    	  const dropdownLabel = document.getElementById("dropdownLabel");
    	  const sizeList = document.getElementById("sizeList");

    	  // 사이즈 목록 추가
    	  for (let size = 220; size <= 300; size += 5) {
    	    const item = document.createElement("div");
    	    item.className = "dropdown-item";
    	    item.textContent = `${size}mm`;
    	    item.addEventListener("click", () => {
    	      dropdownLabel.textContent = `${size}mm 선택됨`;
    	      document.getElementById("selectedSize").value = size; // ✅ 여기서 값 설정
    	      sizeList.style.display = "none";
    	    });
    	    sizeList.appendChild(item);
    	  }

    	  // 옵션 선택 클릭 시 목록 토글
    	  dropdownLabel.addEventListener("click", () => {
    	    sizeList.style.display = sizeList.style.display === "block" ? "none" : "block";
    	  });

    	  // 외부 클릭 시 목록 닫기
    	  window.addEventListener("click", (e) => {
    	    if (!dropdown.contains(e.target)) {
    	      sizeList.style.display = "none";
    	    }
    	  });
    });
</script>

</head>
<body class="bg-light">
	
		<!-- 상단 네비게이션 -->
	<div th:replace="/fragment/nav.html :: nav"></div>

	<div>
		<a href="/cart">장바구니</a>
	</div>

	<div class="container py-5">
		<div class="mb-4">
			<h3 class="fw-bold">신발 상세 정보</h3>
		</div>
		<form method="post" action="/order"
			class="card p-4 shadow-sm bg-white">
			<div class="mb-3" th:each="img : ${item.shoeImg}">
				<img th:src="@{'/upload/' + ${img.uuid} + '_' + ${img.filename}}"
					class="img-fluid mb-2" style="max-width: 200px;" />
			</div>
			<div class="mb-2 fw-semibold" th:text="${item.name}"></div>
			<div class="mb-2 text-muted" th:text="${item.price}"></div>
			<div class="mb-4" th:text="${item.detail}"></div>

			<label class="form-label fw-semibold">발 사이즈 선택</label>
			<div class="dropdown-wrapper mb-4" id="dropdown">
				<div class="dropdown-label" id="dropdownLabel">옵션 선택</div>
				<div class="dropdown-list" id="sizeList"></div>
			</div>
			<input type="hidden" name="size" id="selectedSize" required>
			<input type="hidden" name="storeId" th:value="${item.id}" required>

			<button type="submit" class="btn btn-dark w-100">주문</button>
		</form>
		
		<div>
			<div><label>수량:</label></div>
			<div>
				<input type="number" id="amount" value="1">
			</div>
		</div>

		<div>
			<button id="cart" data-type="cart"
				th:data-login="${customer != null}" th:data-id="${item.id}"
				class="action btn">장바구니</button>
		</div>

		<div>
			<button id="buy" data-type="buy"
				th:data-login="${customer != null}" th:data-id="${item.id}"
				class="action btn">구매하기</button>
		</div>
		
	</div>
</body>
</html>